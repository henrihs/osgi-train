package se.hirt.pi.adafruit.pwm;

import java.io.IOException;

public class Controller {

	private PWMDevice pwm;
	private DcMotor[] motors;

	public Controller(int bus, int address) throws IOException {
		pwm = new PWMDevice(bus, address);
		motors = new DcMotor[] { 
				new DcMotor(this, 1),
				new DcMotor(this, 2),
				new DcMotor(this, 3),
				new DcMotor(this, 4)
				};
		
	}

	public void setPin(int inPin, boolean state) throws IOException {
		if (inPin < 0 || inPin > 15)
			throw new IllegalArgumentException("PWM Pin must be 0 <= pin <= 15");

		if (!state)
			setPwm(inPin, 0, 4096);
		else
			setPwm(inPin, 4096, 0);
	}

	public void setPwm(int channel, int on, int off) throws IOException {
		pwm.getChannel(channel).setPWM(on, off);
	}

	public DcMotor getMotor(int port) {
		if (port < 1 || port > 4)
			throw new IllegalArgumentException("Port number must be 0 < port <= 4");
		return motors[port-1];
	}
}
